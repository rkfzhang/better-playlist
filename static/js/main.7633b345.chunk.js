(this["webpackJsonpbetter-playlist"]=this["webpackJsonpbetter-playlist"]||[]).push([[0],{53:function(e,t,s){},54:function(e,t,s){},86:function(e,t,s){"use strict";s.r(t);var c=s(1),a=s(0),n=s.n(a),i=s(9),r=s.n(i),l=(s(53),s(8)),o=(s(54),s(88)),u=s(89),d=s.p+"static/media/spotify-logo.522b5e00.jpg",h=function(e){return Object(c.jsxs)("div",{className:"login",children:[Object(c.jsx)(o.a,{src:d}),Object(c.jsx)("a",{className:"login-button",href:e.authorizeUrl,children:Object(c.jsx)(u.a,{variant:"outline-success",children:"Login to Spotify"})})]})},j=s(41),b=s(42),m=s(11),y=s.n(m);function f(){return"".concat("https://accounts.spotify.com/authorize","?client_id=").concat("012ed053ecba4a58874cb8a2e753225a","&redirect_uri=").concat("http://sbplaylist.me/","&scope=").concat(["user-read-currently-playing","user-read-recently-played","user-read-playback-state","user-top-read","user-modify-playback-state","streaming","user-read-email","user-read-private"].join("%20"),"&response_type=token&show_dialog=true")}function O(e){"The access token expired"===e.response.data.error.message&&(window.location.href=f())}var p=new(function(){function e(){Object(j.a)(this,e)}return Object(b.a)(e,[{key:"authorize",value:function(){return f()}},{key:"reauthorize",value:function(e){"The access token expired"===e.message&&(window.location.href=this.authorize())}},{key:"getToken",value:function(e){var t=e.substring(1).split("&"),s="";return t.forEach((function(e){e.startsWith("access_token")&&(s=e.substring(13))})),s}},{key:"getSearchResults",value:function(e,t,s){e.length>2&&y()("https://api.spotify.com/v1/search?q=".concat(e,"&limit=").concat(5,"&type=").concat("artist,album,track"),{method:"GET",headers:{Authorization:"Bearer "+t}}).then((function(e){s({tracks:JSON.stringify(e.data.tracks.items),albums:JSON.stringify(e.data.albums.items),artists:JSON.stringify(e.data.artists.items)})})).catch((function(e){O(e),s({tracks:"[]",albums:"[]",artists:"[]"})})),s({tracks:"[]",albums:"[]",artists:"[]"})}},{key:"getAlbumTracks",value:function(e,t,s){y()("https://api.spotify.com/v1/albums/".concat(e,"/tracks"),{method:"GET",headers:{Authorization:"Bearer "+t}}).then((function(e){e.data.items.forEach((function(e){s.push(e.uri)}))})).catch((function(e){console.log(e),O(e)}))}},{key:"getArtistTracks",value:function(e,t,s){var c=this;y()("https://api.spotify.com/v1/artists/".concat(e,"/albums?include_groups=").concat("album,single","&country=").concat("from_token","&limit=50"),{method:"GET",headers:{Authorization:"Bearer "+t}}).then((function(e){e.data.items.forEach((function(e){c.getAlbumTracks(e.id,t,s)}))})).catch((function(e){console.log(e),O(e)}))}},{key:"getArtistAlbums",value:function(e,t,s){y()("https://api.spotify.com/v1/artists/".concat(e,"/albums?include_groups=").concat("album,single","&country=").concat("from_token","&limit=50"),{method:"GET",headers:{Authorization:"Bearer "+t}}).then((function(e){console.log(e),e.data.items.forEach((function(e){s.push(e)}))})).catch((function(e){console.log(e),O(e)}))}},{key:"playerSelectDevice",value:function(e,t){y()("https://api.spotify.com/v1/me/player",{method:"PUT",headers:{Authorization:"Bearer "+t},data:{device_ids:[e]}}).catch((function(e){console.log(e),O(e)}))}},{key:"playerTogglePlayPause",value:function(e,t){e?y()("https://api.spotify.com/v1/me/player/pause",{method:"PUT",headers:{Authorization:"Bearer "+t}}).catch((function(e){console.log(e),O(e)})):y()("https://api.spotify.com/v1/me/player/play",{method:"PUT",headers:{Authorization:"Bearer "+t}}).catch((function(e){console.log(e.response),O(e)}))}},{key:"playerStop",value:function(e){y()("https://api.spotify.com/v1/me/player/pause",{method:"PUT",headers:{Authorization:"Bearer "+e}}).catch((function(e){console.log(e),O(e)}))}},{key:"playerStart",value:function(e,t,s){var c=this;e!==[]&&y()("https://api.spotify.com/v1/me/player/play?device_id=".concat(t),{method:"PUT",headers:{Authorization:"Bearer "+s},data:{uris:e}}).then((function(){c.playerShuffle(s)})).catch((function(e){console.log(e),O(e)}))}},{key:"playerShuffle",value:function(e){y()("https://api.spotify.com/v1/me/player/shuffle?state=true",{method:"PUT",headers:{Authorization:"Bearer "+e}}).catch((function(e){console.log(e),O(e)}))}},{key:"playerPrevious",value:function(e){y()("https://api.spotify.com/v1/me/player/previous",{method:"POST",headers:{Authorization:"Bearer "+e}}).catch((function(e){console.log(e),O(e)}))}},{key:"playerNext",value:function(e){y()("https://api.spotify.com/v1/me/player/next",{method:"POST",headers:{Authorization:"Bearer "+e}}).catch((function(e){console.log(e),O(e)}))}},{key:"playerVolume",value:function(e,t){y()("https://api.spotify.com/v1/me/player/volume?volume_percent=".concat(e),{method:"PUT",headers:{Authorization:"Bearer "+t}}).catch((function(e){console.log(e),O(e)}))}}]),e}()),v=s(21),x=(s(37),function(){return Object(c.jsx)("div",{className:"player-volume",children:Object(c.jsx)(v.a,{defaultValue:"100",step:"10",disabled:"false"})})}),g=s(13),k=function(){return Object(c.jsxs)("div",{className:"player",children:[Object(c.jsx)("div",{}),Object(c.jsxs)("div",{className:"player-buttons",children:[Object(c.jsx)(g.PlayerIcon.Previous,{width:32,height:32}),Object(c.jsx)(g.PlayerIcon.Play,{width:32,height:32}),Object(c.jsx)(g.PlayerIcon.Next,{width:32,height:32})]}),Object(c.jsx)(x,{})]})},P=function(e){return e.currentlyPlayed?Object(c.jsxs)("div",{className:"search-name",children:[Object(c.jsx)("p",{children:e.currentlyPlayed.name}),Object(c.jsx)("p",{children:function(){if(e.currentlyPlayed)var t=e.currentlyPlayed.artists.map((function(e){return e.name}));return t.join(", ")}()})]}):Object(c.jsx)("div",{})},S=function(e){return Object(c.jsx)("div",{className:"player-volume",children:Object(c.jsx)(v.a,{defaultValue:"100",step:"10",onChange:function(t){return s=t,void e.setVolume(s);var s}})})},N=function(e){var t=Object(a.useState)(),s=Object(l.a)(t,2),n=s[0],i=s[1];Object(a.useEffect)((function(){var e=document.createElement("script");e.src="https://sdk.scdn.co/spotify-player.js",e.async=!0,document.body.appendChild(e)}),[]),window.onSpotifyWebPlaybackSDKReady=function(){var t=new window.Spotify.Player({name:"BetterPlaylist Player",getOAuthToken:function(t){t(e.token)}});t.addListener("initialization_error",(function(e){var t=e.message;console.error(t)})),t.addListener("authentication_error",(function(e){var t=e.message;console.error(t)})),t.addListener("account_error",(function(e){var t=e.message;console.error(t)})),t.addListener("playback_error",(function(e){var t=e.message;console.error(t)})),t.addListener("player_state_changed",(function(e){console.log(e),null!==e&&(d(!e.paused),m(e.track_window.current_track))})),t.addListener("ready",(function(t){var s=t.device_id;console.log("Ready with Device ID",s),p.playerSelectDevice(s,e.token),i(s)})),t.addListener("not_ready",(function(e){var t=e.device_id;console.log("Device ID has gone offline",t)})),t.connect()};var r=Object(a.useState)(!1),o=Object(l.a)(r,2),u=o[0],d=o[1],h=Object(a.useState)(""),j=Object(l.a)(h,2),b=j[0],m=j[1],y=Object(a.useState)(100),f=Object(l.a)(y,2),O=f[0],v=f[1];function x(){p.playerTogglePlayPause(u,e.token)}return Object(a.useEffect)((function(){e.songQueue!==[]&&(p.playerStop(e.token),p.playerStart(e.songQueue,n,e.token))}),[e.songQueue,n,e.token]),Object(a.useEffect)((function(){p.playerVolume(O,e.token)}),[O,e.token]),Object(c.jsxs)("div",{className:"player",children:[Object(c.jsx)(P,{currentlyPlayed:b}),Object(c.jsxs)("div",{className:"player-buttons",children:[Object(c.jsx)(g.PlayerIcon.Previous,{width:32,height:32,onClick:function(){p.playerPrevious(e.token)}}),u?Object(c.jsx)(g.PlayerIcon.Pause,{width:32,height:32,onClick:function(){return x()}}):Object(c.jsx)(g.PlayerIcon.Play,{width:32,height:32,onClick:function(){return x()}}),Object(c.jsx)(g.PlayerIcon.Next,{width:32,height:32,onClick:function(){p.playerNext(e.token)}})]}),Object(c.jsx)(S,{setVolume:v})]})},C=s(14),A=s(91),T=s(16),w=s(10),_=s(19),E=s.n(_),z=function(e){var t=Object(a.useState)(!1),s=Object(l.a)(t,2),n=s[0],i=s[1],r=Object(a.useState)([]),o=Object(l.a)(r,2),d=o[0],h=o[1],j=Object(a.useState)(""),b=Object(l.a)(j,2),m=b[0],y=b[1];return Object(a.useEffect)((function(){E.a.get("collection")&&h(E.a.get("collection"))}),[]),Object(a.useEffect)((function(){E.a.set("collection",d)}),[e.playlistChanged,d]),Object(c.jsxs)("div",{className:"collection-section",children:[Object(c.jsx)("h2",{children:"Your Collection"}),Object(c.jsx)("hr",{className:"line-break"}),Object(c.jsx)("div",{children:d.map((function(t){return Object(c.jsxs)("div",{children:[Object(c.jsx)(w.b,{id:t.name+"-"+t.index,children:Object(c.jsx)("p",{"data-index":t.index,onClick:function(t){return s=t.target.dataset.index,e.setSelectedPlaylist(d[s]),void e.setPlaylistChanged(!0);var s},children:t.name})}),Object(c.jsx)(w.a,{id:t.name+"-"+t.index,children:Object(c.jsx)(w.c,{onClick:function(){return function(e){var t=[];d.forEach((function(s){s.index!==e&&(s.index>e&&(s.index-=1),t.push(s))})),h(t),E.a.set("collection",t)}(t.index)},children:"Remove"})})]},t.index)}))}),n?Object(c.jsxs)(A.a,{children:[Object(c.jsx)(T.a.Group,{children:Object(c.jsx)(T.a.Control,{value:m,onChange:function(e){return y(e.target.value)}})}),Object(c.jsxs)("div",{className:"collection-button",children:[Object(c.jsx)(u.a,{onClick:function(){if(m){var e={name:m,index:d.length,items:{tracks:[],albums:[],artists:[]}};h([].concat(Object(C.a)(d),[e])),i(!1),y("")}},children:"Add"}),Object(c.jsx)(u.a,{onClick:function(){i(!n),y("")},children:"Cancel"})]})]}):"",Object(c.jsx)(u.a,{onClick:function(){i(!n)},children:"Add Playlist"})]})},Q=function(e){return Object(c.jsxs)("div",{className:"playlist-header",children:[Object(c.jsx)("h1",{children:e.selectedPlaylist.name}),Object(c.jsx)(u.a,{onClick:function(){return e.selectedPlaylist,void(void 0!==e.currentPlaylist&&e.setSongQueue(e.currentPlaylist))},variant:"success",children:"Play"}),Object(c.jsx)("p",{children:Object(c.jsx)("small",{children:"Please wait ~30s before hitting play to compile playlist"})})]})},B=function(e){return Object(c.jsxs)("div",{className:"playlist-album",children:[Object(c.jsx)("div",{children:e.album.name}),Object(c.jsx)("div",{children:e.album.artists.map((function(e){return e.name})).join(", ")})]})},I=function(e){return Object(c.jsxs)("div",{className:"playlist-artist",children:[Object(c.jsx)("div",{children:e.artist.name}),Object(c.jsx)("div",{children:e.artist.genres?e.artist.genres[0]:""})]})},U=function(e){return Object(c.jsxs)("div",{className:"playlist-track",children:[Object(c.jsx)("div",{children:e.track.name}),Object(c.jsx)("div",{children:e.track.artists.map((function(e){return e.name})).join(", ")}),Object(c.jsx)("div",{children:e.track.album.name})]})},J=function(e){return Object(c.jsxs)("div",{className:"playlist-main",children:[e.selectedPlaylist.items.tracks.length?Object(c.jsx)("h3",{children:"Songs"}):"",e.selectedPlaylist.items.tracks.map((function(t,s){return Object(c.jsxs)("div",{children:[Object(c.jsxs)(w.b,{id:t.name+"-"+s,children:[Object(c.jsx)(U,{track:t}),Object(c.jsx)("hr",{className:"line-break"})]}),Object(c.jsx)(w.a,{id:t.name+"-"+s,children:Object(c.jsx)(w.c,{onClick:function(){return e.removeTrack(s)},children:"Remove"})})]},t.name+"-"+s)})),e.selectedPlaylist.items.albums.length?Object(c.jsx)("h3",{children:"Albums"}):"",e.selectedPlaylist.items.albums.map((function(t,s){return Object(c.jsxs)("div",{children:[Object(c.jsxs)(w.b,{id:t.name+"-"+s,children:[Object(c.jsx)(B,{album:t}),Object(c.jsx)("hr",{className:"line-break"})]}),Object(c.jsx)(w.a,{id:t.name+"-"+s,children:Object(c.jsx)(w.c,{onClick:function(){return e.removeAlbum(s)},children:"Remove"})})]},t.name+"-"+s)})),e.selectedPlaylist.items.artists.length?Object(c.jsx)("h3",{children:"Artists"}):"",e.selectedPlaylist.items.artists.map((function(t,s){return Object(c.jsxs)("div",{children:[Object(c.jsxs)(w.b,{id:t.name+"-"+s,children:[Object(c.jsx)(I,{artist:t,token:e.token}),Object(c.jsx)("hr",{className:"line-break"})]}),Object(c.jsx)(w.a,{id:t.name+"-"+s,children:Object(c.jsx)(w.c,{onClick:function(){return e.removeArtist(s)},children:"Remove"})})]},t.name+"-"+s)})),e.selectedPlaylist.items.tracks.length+e.selectedPlaylist.items.albums.length+e.selectedPlaylist.items.artists.length?" ":Object(c.jsx)("h3",{children:"There's nothing in here"})]})},L=function(e){return Object(c.jsx)("div",{className:"search-bar",children:Object(c.jsx)(T.a.Group,{children:Object(c.jsx)(T.a.Control,{placeholder:"Search",value:e.search,onChange:function(t){return e.setSearchQuery(t.target.value)}})})})},R=s(47),D=s(90),G=function(e){var t=JSON.parse(e.results);return t.length?Object(c.jsxs)("div",{children:[Object(c.jsx)("h2",{children:"Artists"}),t.map((function(t){return Object(c.jsx)(D.a,{children:Object(c.jsxs)("div",{className:"search-container",onClick:function(s){return function(t){var s=e.selectedPlaylist;s.items.artists=[].concat(Object(C.a)(s.items.artists),[t]),e.setSelectedPlaylist(s),e.setSearchQuery(""),e.setPlaylistChanged(!0)}(t)},children:[t.images.length?Object(c.jsx)(o.a,{className:"artist-image",src:t.images[t.images.length-1].url}):"",Object(c.jsx)("div",{className:"search-name",children:Object(c.jsx)("h3",{children:t.name})})]})},t.id)}))]}):""},V=function(e){var t=JSON.parse(e.results);return t.length?Object(c.jsxs)("div",{children:[Object(c.jsx)("h2",{children:"Tracks"}),t.map((function(t){return Object(c.jsx)(D.a,{children:Object(c.jsxs)("div",{className:"search-container",onClick:function(s){return function(t){var s=e.selectedPlaylist;s.items.tracks=[].concat(Object(C.a)(s.items.tracks),[t]),e.setSelectedPlaylist(s),e.setSearchQuery(""),e.setPlaylistChanged(!0)}(t)},children:[t.album.images.length?Object(c.jsx)(o.a,{src:t.album.images[t.album.images.length-1].url,rounded:!0}):"",Object(c.jsxs)("div",{className:"search-name",children:[Object(c.jsx)("h3",{children:t.name}),Object(c.jsx)("p",{children:t.artists[0].name})]})]})},t.id)}))]}):""},M=function(e){var t=JSON.parse(e.results);return t.length?Object(c.jsxs)("div",{children:[Object(c.jsx)("h2",{children:"Albums"}),t.map((function(t){return Object(c.jsx)(D.a,{children:Object(c.jsxs)("div",{className:"search-container",onClick:function(s){return function(t){var s=e.selectedPlaylist;s.items.albums=[].concat(Object(C.a)(s.items.albums),[t]),e.setSelectedPlaylist(s),e.setSearchQuery(""),e.setPlaylistChanged(!0)}(t)},children:[t.images.length?Object(c.jsx)(o.a,{src:t.images[2].url,roundedCircle:!0}):"",Object(c.jsxs)("div",{className:"search-name",children:[Object(c.jsx)("h3",{children:t.name}),Object(c.jsx)("p",{children:t.artists[0].name})]})]})},t.id)}))]}):""},W=function(e){return e.results.tracks.length+e.results.artists.length+e.results.albums.length?Object(c.jsxs)("div",{className:"search-results",children:[Object(c.jsx)(R.a,{children:Object(c.jsx)(V,{results:e.results.tracks,selectedPlaylist:e.selectedPlaylist,setPlaylistChanged:e.setPlaylistChanged,setSelectedPlaylist:e.setSelectedPlaylist,setSearchQuery:e.setSearchQuery})}),Object(c.jsx)(R.a,{children:Object(c.jsx)(G,{results:e.results.artists,selectedPlaylist:e.selectedPlaylist,setPlaylistChanged:e.setPlaylistChanged,setSelectedPlaylist:e.setSelectedPlaylist,setSearchQuery:e.setSearchQuery})}),Object(c.jsx)(R.a,{children:Object(c.jsx)(M,{results:e.results.albums,selectedPlaylist:e.selectedPlaylist,setPlaylistChanged:e.setPlaylistChanged,setSelectedPlaylist:e.setSelectedPlaylist,setSearchQuery:e.setSearchQuery})})]}):""},q=function(e){var t=Object(a.useState)(""),s=Object(l.a)(t,2),n=s[0],i=s[1],r=Object(a.useState)({tracks:[],albums:[],artists:[]}),o=Object(l.a)(r,2),u=o[0],d=o[1];return Object(a.useEffect)((function(){d(void p.getSearchResults(n,e.token,d))}),[n,e.token]),Object(c.jsxs)("div",{className:"search-section",children:[Object(c.jsx)(L,{search:n,result:u,setSearchQuery:i}),u?Object(c.jsx)(W,{results:u,selectedPlaylist:e.selectedPlaylist,setSelectedPlaylist:e.setSelectedPlaylist,setSearchQuery:i,setPlaylistChanged:e.setPlaylistChanged}):""]})},K=function(e){var t=Object(a.useState)(),s=Object(l.a)(t,2),n=s[0],i=s[1],r=Object(a.useState)(!1),o=Object(l.a)(r,2),u=o[0],d=o[1],h=Object(a.useState)(),j=Object(l.a)(h,2),b=j[0],m=j[1];return Object(a.useEffect)((function(){d(!1),function(){if(n){var t=[];n.items.tracks.forEach((function(e){t.push(e.uri)})),n.items.albums.forEach((function(s){p.getAlbumTracks(s.id,e.token,t)})),n.items.artists.forEach((function(s){p.getArtistTracks(s.id,e.token,t)})),m(t)}}()}),[u,e.token,n]),Object(c.jsxs)("div",{className:"App-Main",children:[Object(c.jsx)(z,{setSelectedPlaylist:i,playlistChanged:u,setPlaylistChanged:d}),Object(c.jsx)("div",{className:"playlist-section",children:void 0!==n||n?Object(c.jsxs)("div",{children:[Object(c.jsx)(Q,{selectedPlaylist:n,setSongQueue:e.setSongQueue,token:e.token,currentPlaylist:b}),Object(c.jsx)(q,{selectedPlaylist:n,setSelectedPlaylist:i,token:e.token,setPlaylistChanged:d}),Object(c.jsx)(J,{selectedPlaylist:n,removeTrack:function(e){var t=n,s=t.items.tracks;s.splice(e,1),t.items.tracks=s,i(t),d(!0)},removeAlbum:function(e){var t=n,s=t.items.albums;s.splice(e,1),t.items.albums=s,i(t),d(!0)},removeArtist:function(e){var t=n,s=t.items.artists;s.splice(e,1),t.items.artists=s,i(t),d(!0)},token:e.token})]}):Object(c.jsx)("div",{children:Object(c.jsx)("h2",{className:"playlist-none",children:"No playlist selected"})})})]})};var Y=function(){var e=Object(a.useState)(""),t=Object(l.a)(e,2),s=t[0],n=t[1];Object(a.useEffect)((function(){var e=p.getToken(window.location.hash);n(e)}),[]);var i=Object(a.useState)([]),r=Object(l.a)(i,2),o=r[0],u=r[1];return Object(c.jsxs)("div",{className:"App",children:[s?Object(c.jsx)(K,{token:s,setSongQueue:u}):Object(c.jsx)(h,{authorizeUrl:p.authorize()}),s?Object(c.jsx)(N,{token:s,songQueue:o}):Object(c.jsx)(k,{})]})};s(85);r.a.render(Object(c.jsx)(n.a.StrictMode,{children:Object(c.jsx)(Y,{})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.7633b345.chunk.js.map